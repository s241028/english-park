<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>English Park</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&family=Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <!-- オープニング画面 -->
    <div id="splash-screen" class="screen active">
        <!-- 画像を変更したい場合はsrcを書き換えてください -->
        <img src="https://assets.stickpng.com/thumbs/580b57fcd9996e24bc43c1ee.png" alt="English Park Logo" class="splash-logo">
        <h1>English Park</h1>
        <p>Welcome to your English learning journey!</p>
        <button id="enter-app-button" class="action-button">スタート</button>
    </div>

    <!-- ホーム画面 -->
    <main id="home-screen" class="screen">
        <div class="container">
            <h1>English Park 🌳</h1>
            <p class="description">ミニゲームを選んで英語を楽しく学ぼう！</p>
            
            <div id="idiom-of-the-day-card" class="card idiom-card">
                <div class="card-header">
                    <h2>💡 今日のイディオム</h2>
                    <span id="idiom-date" class="date-display"></span>
                </div>
                <h3 id="idiom-phrase">Loading...</h3>
                <p><strong>意味:</strong> <span id="idiom-meaning"></span></p>
                <p id="idiom-description" class="sentence-meaning"></p>
            </div>

            <div class="game-selection">
                <div class="game-card" id="start-speaking-practice">
                    <div class="game-icon">🗣️</div>
                    <h3>スピーキング練習</h3>
                    <p>発音、リズム、ペースを総合的に練習します。</p>
                </div>
                <div class="game-card" id="go-to-quiz-levels">
                    <div class="game-icon">✍️</div>
                    <h3>単語クイズ</h3>
                    <p>4つのレベルで語彙力をテストしよう。</p>
                </div>
                <div class="game-card" id="start-listening-challenge">
                    <div class="game-icon">🎧</div>
                    <h3>リスニングチャレンジ</h3>
                    <p>英語の音声を聞き取って書き起こしてみよう。</p>
                </div>
                 <div class="game-card" id="start-reading-quiz">
                    <div class="game-icon">📚</div>
                    <h3>読解練習</h3>
                    <p>短い英文を読み、内容に関するクイズに挑戦しよう。</p>
                </div>
                <div class="game-card" id="start-video-chat">
                    <div class="game-icon">📞</div>
                    <h3>音声通話チャット</h3>
                    <p>お題について英語でフリートークしよう。</p>
                </div>
            </div>
        </div>
    </main>

    <!-- スピーキング練習画面 -->
    <main id="speaking-practice-screen" class="screen">
        <div class="container">
            <button id="backButtonSpeaking" class="back-button">🏠 ホームに戻る</button>
            <h1>スピーキング練習 🗣️</h1>
            <p class="description">お手本を聞いてから、マイクに向かって発音してみましょう。発音の正確さ、ペース、聞き比べができます。</p>
            <div class="card">
                <div class="card-header">
                    <h2>お題</h2>
                    <button id="nextButton">次のお題へ 🔄</button>
                </div>
                <p id="sentence"></p>
                <p id="sentence-meaning" class="sentence-meaning"></p>
            </div>
            <div class="controls">
                <button id="listenButton" class="listen-btn">お手本を聞く 🎧</button>
                <button id="startButton">録音開始 🎙️</button>
                <button id="stopButton" disabled>録音停止 ⏹️</button>
            </div>
            <div id="status" class="status"></div>
            <div class="result-container">
                <div class="card card-score"><h2>スコア</h2><p id="score">0 <span class="score-unit">/ 100</span></p></div>
                <div class="card">
                    <h2>あなたの録音</h2>
                    <audio id="user-recording-player" controls class="user-audio-player"></audio>
                </div>
                <div class="card feedback-card"><h2>フィードバック</h2><p id="feedback">-</p></div>
            </div>
        </div>
    </main>

    <!-- クイズレベル選択画面 -->
    <main id="quiz-level-screen" class="screen">
        <div class="container">
            <button id="backButtonFromLevels" class="back-button">🏠 ホームに戻る</button>
            <h1>単語クイズ ✍️</h1>
            <p class="description">挑戦するレベルを選んでください。</p>
            <div class="level-selection-grid">
                <div class="level-card" data-level="beginner">
                    <h3>初級編</h3>
                    <p>英検3級レベル</p>
                </div>
                <div class="level-card" data-level="intermediate">
                    <h3>中級編</h3>
                    <p>英検準2級・2級レベル</p>
                </div>
                <div class="level-card" data-level="advanced">
                    <h3>上級編</h3>
                    <p>英検準1級レベル</p>
                </div>
                <div class="level-card" data-level="expert">
                    <h3>最上級編</h3>
                    <p>英検1級・TOEIC 800+</p>
                </div>
            </div>
        </div>
    </main>

    <!-- 単語クイズ画面 -->
    <main id="word-quiz-screen" class="screen">
        <div class="container">
            <button id="backButtonFromQuiz" class="back-button">📜 レベル選択に戻る</button>
            <h1>単語クイズ ✍️</h1>
            <div id="quiz-game-area">
                <div class="card quiz-card">
                    <div id="quiz-hud"><span id="quiz-question-counter"></span><span id="quiz-score"></span></div>
                    <p id="quiz-question"></p>
                    <div id="quiz-options" class="quiz-options-grid"></div>
                    <div id="quiz-feedback"></div>
                </div>
            </div>
            <div id="quiz-end-screen" class="card" style="display: none;">
                <h2>クイズ終了！</h2>
                <p class="final-score-text">あなたの最終スコアは...</p>
                <p id="quiz-final-score"></p>
                <button id="quiz-restart-button" class="restart-button">もう一度挑戦する</button>
            </div>
        </div>
    </main>

    <!-- リスニングチャレンジ画面 -->
    <main id="listening-challenge-screen" class="screen">
        <div class="container">
            <button id="backButtonFromListening" class="back-button">🏠 ホームに戻る</button>
            <h1>リスニングチャレンジ 🎧</h1>
            <p class="description">再生ボタンを押して英語の音声を聞き、下のボックスに書き起こしてください。</p>
            <div id="listening-game-area">
                <div class="card listening-card">
                    <div class="listening-controls">
                        <button id="play-audio-button" class="play-audio-btn">音声を再生 ▶️</button>
                        <p id="listening-status" class="status"></p>
                    </div>
                    <textarea id="listening-input" class="listening-textarea" placeholder="ここに聞き取った英文を入力..." rows="3"></textarea>
                    <button id="submit-listening-button" class="submit-btn">答え合わせ</button>
                </div>
                <div id="listening-feedback-area" class="card" style="display: none;">
                    <h2 id="listening-result-title">結果</h2>
                    <p id="listening-feedback-text"></p>
                    <p><strong>正解:</strong> <span id="listening-correct-answer"></span></p>
                    <button id="next-listening-button" class="next-btn">次の問題へ 🔄</button>
                </div>
            </div>
        </div>
    </main>

    <!-- 読解練習画面 -->
    <main id="reading-quiz-screen" class="screen">
        <div class="container">
            <button id="backButtonFromReading" class="back-button">🏠 ホームに戻る</button>
            <h1>読解練習 📚</h1>
            <div id="reading-game-area">
                <div class="card reading-passage-card">
                    <h2 id="reading-title"></h2>
                    <p id="reading-passage"></p>
                </div>
                <div class="card quiz-card">
                    <div id="reading-hud"><span id="reading-question-counter"></span><span id="reading-score"></span></div>
                    <p id="reading-question"></p>
                    <div id="reading-options" class="quiz-options-grid"></div>
                    <div id="reading-feedback"></div>
                </div>
            </div>
            <div id="reading-end-screen" class="card" style="display: none;">
                <h2>読解クイズ終了！</h2>
                <p class="final-score-text">あなたの最終スコアは...</p>
                <p id="reading-final-score"></p>
                <button id="reading-restart-button" class="restart-button">別の文章に挑戦する</button>
            </div>
        </div>
    </main>

    <!-- ビデオチャット画面 (音声通話モード) -->
    <main id="video-chat-screen" class="screen">
        <div class="container">
            <button id="backButtonFromVideo" class="back-button">🏠 ホームに戻る</button>
            <h1>音声通話チャット 📞</h1>
            <div id="video-topic-card" class="card">
                <h2>Conversation Topic</h2>
                <p id="video-topic">What is the most interesting place you have ever visited?</p>
            </div>
            
            <!-- 音声プレーヤーを表示（カメラなし対応） -->
            <div class="card" style="text-align: center;">
                <h3>相手の声</h3>
                <audio id="remote-audio" controls autoplay style="width: 100%; margin-top: 10px;"></audio>
                <p style="font-size: 0.9em; color: #888; margin-top: 5px;">※再生バーが動かない場合は接続を確認してください</p>
            </div>

            <div id="video-controls">
                <button id="start-call-btn">Start Call</button>
                <button id="end-call-btn" disabled>End Call</button>
            </div>
            <div id="video-status" class="status"></div>
        </div>
    </main>

    <script src="script.js"></script>
</body>
</html>